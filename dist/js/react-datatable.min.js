!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.RDT=e(require("react")):t.RDT=e(t.React)}(this,function(t){return function(t){function e(s){if(r[s])return r[s].exports;var n=r[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var s=r(2),n=r(4)(r(1),r(3));n.datasource=function(t,e){return new s(t,e)},t.exports=n},function(e){e.exports=t},function(t,e,r){"use strict";var s=r(11).EventEmitter,n=r(5),i=function(t,e,r){if(t instanceof Array)this.records=e?t.map(e):t;else{var s=t.data,n=t.datasource;this.records=n[s]}this.config=r,r&&(this.properyConfigMap={},this.config.cols.forEach(function(t){this.properyConfigMap[t.property]=t}.bind(this))),this.sortedInfo=null};i.prototype=s.prototype,i.prototype.constructor=i,i.prototype.record=function(t){return this.records[t]},i.prototype.empty=function(){this.records=[],this.emit("recordsUpdated")},i.prototype.append=function(t){this.records.push(t),this.emit("recordAdded",t)},i.prototype.length=function(){return this.records.length},i.prototype.sort=function(t,e){this.records.sort(function(r,s){var i=1;"-1"===e&&(i=-1);var o=this.properyConfigMap[t],a=n.extractValue(t,o.path,r),p=n.extractValue(t,o.path,s),c=n.extractSortableType(a,p);return n.compare(c,a,p,i)}.bind(this)),this.sortedInfo={property:t,direction:e}},i.prototype.map=function(t,e){if(!t)return this.records.map(e);for(var r=[],s=0,n=t.startIdx;n<t.endIdx;n++)r.push(e(this.records[n],s++,n));return r},i.prototype.updateRecord=function(t,e,r,s){var n=this.records[t],i=s.path?s.path:e,o=s.setter?function(t,e,r){var s=r.setter;"string"==typeof r.setter?n[r.setter](t,e,r):s.call(n,t,e,r)}:function(){i.split(".").reduce(function(t,e,s,n){return s!==n.length-1?t[e]:void("function"==typeof t[e]?t[e](r):t[e]=r)},n)};o.call(n,r,e,s),this.emit("recordUpdated",n,t,e,r)},t.exports=i},function(t,e,r){var s=r(1),n=r(2),i=r(6),o=(r(7),r(8)),a=r(9),p=r(10),c={pure:{table:"pure-table pure-table-bordered"},"pure-striped":{table:"pure-table pure-table-bordered pure-table-striped"},bootstrap:{table:"table table-bordered"},foundation:{table:""}},h=s.createClass({displayName:"RDT",onClick:function(t){var e=t.target,r=e.getAttribute("data-rdt-action");if("sort"===r){var s=e.getAttribute("data-col-property"),n=e.getAttribute("data-sort-direction");this.state.datasource.sort(s,n),this.forceUpdate()}},sort:function(){},nextPage:function(){this.pager&&(this.pager=this.pager.next(),this.setState({pager:this.pager.state()}))},add:function(t){this.ds.add(t);var e=null;this.pager&&(e=this.pager.state()),this.setState({pager:e})},onDsChangeEvent:function(){this.props.onChange&&this.props.onChange()},getInitialState:function(){var t=this.props,e=null;t.data?e=new n(t.data,this.props.mapper,this.props.config):t.datasource&&(e=t.datasource);var r=null;return this.props.config.pager&&this.props.config.pager&&(r=new i(1,this.props.config.pager.rowsPerPage,this.ds)),{datasource:e,pager:r}},pagerUpdated:function(t){this.pager&&(this.pager=this.pager.toPage(t),this.setState({pager:this.pager.state()}))},render:function(){var t=c[this.props.config.style],e=this.props.config,r=this.state.datasource,n=null;return this.state.pager&&(n=s.createElement(p,{datasource:r,config:this.props.config,pageChangedListener:this.pagerUpdated})),s.createElement("div",{onClick:this.onClick},s.createElement("div",{className:"rdt-container",ref:"container"},s.createElement("table",{className:t.table},s.createElement(o,{datasource:r,config:e}),s.createElement(a,{config:e,datasource:r,pager:this.state.pager}))),n)}});t.exports=h},function(t){"use strict";var e=function(t,e,r){return t.createElement(e,r)},r=function(t,r,s,n){var i={},o=null;return s.tagName&&s.nodeName&&"number"==typeof s.nodeType||"string"==typeof s?o=s:(i=s,o="string"==typeof n?document.getElementById(n):n),t.render(e(t,r,i),o)},s=function(t,s){return{cls:s,el:function(r){return e(t,s,r)},render:function(e,n){return r(t,s,e,n)}}};t.exports=s},function(t){"use require";t.exports={extractValue:function(t,e,r){var s="";return"string"==typeof t&&(e?s="string"==typeof e?e.split(".").reduce(function(t,e){return t&&e?t[e]:null},r):e(t,r):(s=r[t],"function"==typeof s&&(s=s.call(r)))),s},extractSortableType:function(t,e){return"string"==typeof t&&"string"==typeof e?String:"number"==typeof t&&"number"==typeof e?Number:t instanceof Date&&e instanceof Date?Date:null},compare:function(t,e,r,s){return t===Number?e&&r?(r-e)*s:e&&!r?e*s:!e&&r?r*s:0:e?e.localeCompare(r)*s:r?r.localeCompare(e)*s:0}}},function(t){"use strict";var e=function(t,e,r){this.datasource=r,this.page=t,this.rowsPerPage=e,this.startIdx=(this.page-1)*e,this.endIdx=this.startIdx+this.rowsPerPage<this.datasource.records.length?this.startIdx+this.rowsPerPage:this.startIdx+(this.datasource.records.length-this.startIdx)};e.prototype.next=function(){return this.move(1)},e.prototype.previous=function(){return this.move(-1)},e.prototype.toPage=function(t){return this.move(t-this.page)},e.prototype.maxPage=function(){var t=parseInt(this.datasource.records.length/this.rowsPerPage);return this.datasource.records.length%this.rowsPerPage>0&&(t+=1),t},e.prototype.move=function(t){var r=this.maxPage();return this.page+t>r||this.page+t<0?this:new e(this.page+t,this.rowsPerPage,this.datasource)},e.prototype.state=function(){return{page:this.page+1,startIdx:this.startIdx,endIdx:this.endIdx,rowsPerPage:this.rowsPerPage}},t.exports=e},function(t,e,r){var s=r(1),n=r(12),i=s.createClass({displayName:"RDTRow",componentWillReceiveProps:function(t){this.setState({record:t.record})},getInitialState:function(){return{record:this.props.record}},onCellChange:function(){this.setState({record:this.props.record})},render:function(){var t=this.props.config.cols,e=this.state.record,r=this.props.ds;return s.createElement("tr",{"data-index":this.props.index},t.map(function(t,i){return s.createElement(n,{onCellChange:this.onCellChange,index:this.props.index,key:i,ds:r,col:t,property:t.property,record:e,path:t.path})}.bind(this)))}});t.exports=i},function(t,e,r){var s=r(1),n="1",i="-1",o=s.createClass({displayName:"SortControl",getInitialState:function(){return{direction:this.props.direction,isSortedColumn:this.props.isSortedColumn}},componentWillReceiveProps:function(t){this.props.isSortedColumn!==t.isSortedColumn&&this.setState({direction:t.direction,isSortedColumn:t.isSortedColumn})},render:function(){var t=this.state.isSortedColumn&&this.state.direction===n?"rdt-arrow-up-active":"rdt-arrow-up-inactive",e=this.state.isSortedColumn&&this.state.direction===i?"rdt-arrow-down-active":"rdt-arrow-down-inactive";return s.createElement("div",{style:{"float":"right"}},s.createElement("div",{"data-rdt-action":"sort","data-col-property":this.props.col.property,"data-sort-direction":n,className:"rdt-arrow-up "+t}),s.createElement("div",{style:{marginBottom:"5px"}}),s.createElement("div",{"data-rdt-action":"sort","data-col-property":this.props.col.property,"data-sort-direction":i,className:"rdt-arrow-down "+e}))}}),a=s.createClass({displayName:"RDTColumn",getInitialState:function(){return{datasource:this.props.datasource}},render:function(){var t=this.props.config.cols,e=this.state.datasource,r=e.sortedInfo;return s.createElement("thead",{onClick:this.onClick},s.createElement("tr",null,t.map(function(t,e){var n=!1,i=null;return r&&r.property===t.property&&(n=!0,i=r.direction),s.createElement("td",{"data-th-key":t.property,key:t.property+"-th-"+e},s.createElement("div",null,s.createElement("span",null,t.header),s.createElement(o,{isSortedColumn:n,direction:i,col:t})))}.bind(this))))}});t.exports=a},function(t,e,r){var s=r(1),n=r(7),i=s.createClass({displayName:"RDTBody",componentWillReceiveProps:function(t){this.setState({pager:t.pager,ds:t.datasource})},getInitialState:function(){return{pager:this.props.pager,ds:this.props.datasource}},render:function(){return s.createElement("tbody",null,this.state.ds.map(this.state.pager,function(t,e,r){var i=e;return r&&!Array.isArray(r)&&(i=r),s.createElement(n,{index:i,ds:this.state.ds,key:i,record:t,config:this.props.config})}.bind(this)))}});t.exports=i},function(t,e,r){var s=r(1),n=s.createClass({displayName:"Paginator",getInitialState:function(){return{page:this.props.page}},componentWillReceiveProps:function(t){this.setState({page:t.page})},pageSelectionHandler:function(){this.props.pageChangedListener&&this.props.pageChangedListener(this.refs.pageSelection.getDOMNode().value)},render:function(){var t=this.state.page,e=[],r=parseInt(this.props.datasource.records.length/this.props.config.pager.rowsPerPage);this.props.datasource.records.length%this.props.config.pager.rowsPerPage!=0&&(r+=1);for(var n=1;r>=n;n++)e.push(n);return s.createElement("div",{className:"rdt-paginator"},s.createElement("div",null,s.createElement("select",{value:t,ref:"pageSelection",onChange:this.pageSelectionHandler},e.map(function(t){return s.createElement("option",{key:t,value:t},t)}))))}});t.exports=n},function(t){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function s(t){return"number"==typeof t}function n(t){return"object"==typeof t&&null!==t}function i(t){return void 0===t}t.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(t){if(!s(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},e.prototype.emit=function(t){var e,s,o,a,p,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(s=this._events[t],i(s))return!1;if(r(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,a=new Array(o-1),p=1;o>p;p++)a[p-1]=arguments[p];s.apply(this,a)}else if(n(s)){for(o=arguments.length,a=new Array(o-1),p=1;o>p;p++)a[p-1]=arguments[p];for(c=s.slice(),o=c.length,p=0;o>p;p++)c[p].apply(this,a)}return!0},e.prototype.addListener=function(t,s){var o;if(!r(s))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(s.listener)?s.listener:s),this._events[t]?n(this._events[t])?this._events[t].push(s):this._events[t]=[this._events[t],s]:this._events[t]=s,n(this._events[t])&&!this._events[t].warned){var o;o=i(this._maxListeners)?e.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){function s(){this.removeListener(t,s),n||(n=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var n=!1;return s.listener=e,this.on(t,s),this},e.prototype.removeListener=function(t,e){var s,i,o,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=this._events[t],o=s.length,i=-1,s===e||r(s.listener)&&s.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(n(s)){for(a=o;a-->0;)if(s[a]===e||s[a].listener&&s[a].listener===e){i=a;break}if(0>i)return this;1===s.length?(s.length=0,delete this._events[t]):s.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},e.prototype.removeAllListeners=function(t){var e,s;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(s=this._events[t],r(s))this.removeListener(t,s);else for(;s.length;)this.removeListener(t,s[s.length-1]);return delete this._events[t],this},e.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},e.listenerCount=function(t,e){var s;return s=t._events&&t._events[e]?r(t._events[e])?1:t._events[e].length:0}},function(t,e,r){var s=r(1),n=r(5),i=s.createClass({displayName:"RDTCell",componentWillReceiveProps:function(t){this.setState({record:t.record,editMode:!1})},convertToType:function(t,e){return"number"==typeof t?t%1===0?parseInt(e):parseFloat(e):e},getDisplayStyle:function(){var t=this.refs.td.getDOMNode(),e=t.offsetWidth,r=t.offsetHeight,s=t.offsetLeft,n=t.offsetTop;return{width:e,height:r,top:n,left:s}},componentDidMount:function(){this.refs.input&&this.refs.input.getDOMNode().focus()},componentDidUpdate:function(){this.refs.input&&this.refs.input.getDOMNode().focus()},onClickHandler:function(t){t.target;!this.state.editMode&&this.props.col.editable&&this.setState({record:this.state.record,property:this.state.property,editMode:!0})},onKeyUp:function(t){var e=t.type,r=t.which,s=13;if("keyup"===e&&r===s&&this.refs.input){{var n=this.convertToType(this.state.record[this.state.property],this.refs.input.getDOMNode().value),i=this.props.ds;this.props.index}i.updateRecord(this.props.index,this.props.property,n,this.props.col),this.setState({record:this.state.record,editMode:!1}),this.props.onCellChange&&this.props.onCellChange()}},onInputChange:function(){},onBlur:function(){this.setState({editMode:!1})},getInitialState:function(){return{record:this.props.record,editMode:!1}},createEditor:function(){var t=this.props.col.editable||!1,e=this.state.editMode;return t&&e?s.createElement("input",{onKeyUp:this.onKeyUp,ref:"input",onBlur:this.onBlur,className:"rdt-editor",style:this.getDisplayStyle(),onKeyUp:this.onKeyUp,onChange:this.onInputChange,ref:"input",defaultValue:this.getValue()}):null},getValue:function(){var t=this.props.path,e=this.state.record,r=this.props.property;return n.extractValue(r,t,e)},render:function(){var t=this.state.record,e=this.props.property,r=this.getValue();return this.props.col.formatter&&(r=this.props.col.formatter(r,e,t,s)),s.createElement("td",{ref:"td",onClick:this.onClickHandler,"data-property":e,key:e},s.createElement("div",null,r),this.createEditor())}});t.exports=i}])});