!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.RDT=e(require("react")):t.RDT=e(t.React)}(this,function(t){return function(t){function e(s){if(r[s])return r[s].exports;var n=r[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var s=r(2),n=r(4)(r(1),r(3));n.datasource=function(t,e){return new s(t,e)},t.exports=n},function(e){e.exports=t},function(t,e,r){"use strict";var s=r(5),n=r(12).EventEmitter,o=r(6),i={RECORD_UPDATED:"RECORD_UPDATED",RECORD_ADDED:"RECORD_ADDED",RECORDS_SORTED:"RECORDS_SORTED"},a=function(t,e){var r=o.colsToMap(e);return function(e,n){var o=null;return o="function"==typeof t?t(e):e,new s(n,o,r)}},p=function(t,e,r){this.id=new Date;var s=a(e,r);if(t instanceof Array)this.records=s?t.map(s):t;else{var n=t.data,o=t.datasource;this.records=o[n]}this.config=r,r&&(this.properyConfigMap={},this.config.cols.forEach(function(t){this.properyConfigMap[t.property]=t}.bind(this))),this.sortedInfo=null};p.prototype=n.prototype,p.prototype.constructor=p,p.prototype.record=function(t){return this.records[t]},p.prototype.append=function(t){this.records.push(t),this.emit(i.RECORD_ADDED,t)},p.prototype.length=function(){return this.records.length},p.prototype.sort=function(t,e){this.records.sort(function(r,s){var n=1;"-1"===e&&(n=-1);var i=this.properyConfigMap[t],a=o.extractValue(t,i.path,r.__record),p=o.extractValue(t,i.path,s.__record),c=o.extractSortableType(a,p);return o.compare(c,a,p,n)}.bind(this)),this.emit(i.RECORDS_SORTED,{property:t,direction:e})},p.prototype.map=function(t,e){if(!t)return this.records.map(e);for(var r=[],s=0,n=t.startIdx;n<t.endIdx;n++)r.push(e(this.records[n],s++,n));return r},p.prototype.updateRecord=function(t,e,r){var s=this.records[t];s.update(e,r),this.emit(i.RECORD_UPDATED,s,t,e,r)},t.exports=p},function(t,e,r){"use strict";var s=r(1),n=r(2),o=r(7),i=(r(8),r(9)),a=r(10),p=r(11),c={pure:{table:"pure-table pure-table-bordered"},"pure-striped":{table:"pure-table pure-table-bordered pure-table-striped"},bootstrap:{table:"table table-bordered"},foundation:{table:""}},u=s.createClass({displayName:"RDT",onClick:function(t){var e=t.target,r=e.getAttribute("data-rdt-action");if("sort"===r){var s=e.getAttribute("data-col-property"),n=e.getAttribute("data-sort-direction");this.state.datasource.sort(s,n),this.forceUpdate()}},componentWillReceiveProps:function(t){this.setState(this._createStateFromProps(t))},nextPage:function(){this.pager&&(this.pager=this.pager.next(),this.setState({pager:this.pager.state()}))},add:function(t){this.ds.add(t);var e=null;this.pager&&(e=this.pager.state()),this.setState({pager:e})},onDsChangeEvent:function(){this.props.onChange&&this.props.onChange()},_createStateFromProps:function(t){var e=null,r=null;return t.data?e=new n(t.data,t.mapper,t.config):t.datasource&&(e=t.datasource),e||(e=new n([],t.mapper,t.config)),t.config.pager&&t.config.pager&&(r=new o(1,t.config.pager.rowsPerPage,e)),{datasource:e,pager:r}},getInitialState:function(){return this._createStateFromProps(this.props)},pagerUpdated:function(t){this.pager&&(this.pager=this.pager.toPage(t),this.setState({pager:this.pager.state()}))},render:function(){var t=c[this.props.config.style],e=this.props.config,r=this.state.datasource,n=null;return this.state.pager&&(n=s.createElement(p,{datasource:r,config:this.props.config,pageChangedListener:this.pagerUpdated})),s.createElement("div",{onClick:this.onClick},s.createElement("div",{className:"rdt-container",ref:"container"},s.createElement("table",{className:t.table},s.createElement(i,s.__spread({},this.props,{datasource:r})),s.createElement(a,{config:e,datasource:r,pager:this.state.pager}))),n)}});t.exports=u},function(t){"use strict";var e=function(t,e,r){return t.createElement(e,r)},r=function(t,r,s,n){var o={},i=null;return s.tagName&&s.nodeName&&"number"==typeof s.nodeType||"string"==typeof s?i=s:(o=s,i="string"==typeof n?document.getElementById(n):n),t.render(e(t,r,o),i)},s=function(t,s){return{cls:s,el:function(r){return e(t,s,r)},render:function(e,n){return r(t,s,e,n)}}};t.exports=s},function(t,e,r){"use strict";var s=r(6),n=function(t,e,r){this.__record=e,this.index=t,this.colsMap=r};n.prototype.getValue=function(t){var e=this.colsMap[t].path;return s.extractValue(t,e,this.__record)},n.prototype.update=function(t,e){var r=this.colsMap[t],s=this.__record,n=r.path?r.path:t,o=r.setter?function(t,e,r){var n=r.setter;"string"==typeof r.setter?s[r.setter](t,e,r):n.call(s,t,e,r)}:function(){n.split(".").reduce(function(t,r,s,n){return s!==n.length-1?t[r]:void("function"==typeof t[r]?t[r](e):t[r]=e)},s)};o.call(s,e,t,r)},t.exports=n},function(t){"use strict";t.exports={colsToMap:function(t){var e={};return t.cols.forEach(function(t){e[t.property]=t}),e},extractValue:function(t,e,r){var s="";return"string"==typeof t&&(e?s="string"==typeof e?e.split(".").reduce(function(t,e){return t&&e?t[e]:null},r):e(t,r):(s=r[t],"function"==typeof s&&(s=s.call(r)))),s},extractSortableType:function(t,e){return"string"==typeof t&&"string"==typeof e?String:"number"==typeof t&&"number"==typeof e?Number:t instanceof Date&&e instanceof Date?Date:null},compare:function(t,e,r,s){return t===Number?e&&r?(r-e)*s:e&&!r?e*s:!e&&r?r*s:0:e?e.localeCompare(r)*s:r?r.localeCompare(e)*s:0}}},function(t){"use strict";var e=function(t,e,r){this.datasource=r,this.page=t,this.rowsPerPage=e,this.startIdx=(this.page-1)*e,this.endIdx=this.startIdx+this.rowsPerPage<this.datasource.records.length?this.startIdx+this.rowsPerPage:this.startIdx+(this.datasource.records.length-this.startIdx)};e.prototype.next=function(){return this.move(1)},e.prototype.previous=function(){return this.move(-1)},e.prototype.toPage=function(t){return this.move(t-this.page)},e.prototype.maxPage=function(){var t=parseInt(this.datasource.records.length/this.rowsPerPage);return this.datasource.records.length%this.rowsPerPage>0&&(t+=1),t},e.prototype.move=function(t){var r=this.maxPage();return this.page+t>r||this.page+t<0?this:new e(this.page+t,this.rowsPerPage,this.datasource)},e.prototype.state=function(){return{page:this.page+1,startIdx:this.startIdx,endIdx:this.endIdx,rowsPerPage:this.rowsPerPage}},t.exports=e},function(t,e,r){"use strict";var s=r(1),n=r(13),o=s.createClass({displayName:"RDTRow",componentWillReceiveProps:function(t){this.setState({record:t.record})},getInitialState:function(){return{record:this.props.record}},onCellChange:function(){this.setState({record:this.props.record})},render:function(){var t=this.props.config.cols,e=this.state.record;return s.createElement("tr",{"data-index":this.props.index},t.map(function(t,r){return s.createElement(n,{config:this.props.config,onCellChange:this.onCellChange,index:this.props.index,key:r,datasource:this.props.datasource,col:t,property:t.property,record:e,path:t.path})}.bind(this)))}});t.exports=o},function(t,e,r){"use strict";var s=r(1),n="1",o="-1",i=s.createClass({displayName:"SortControl",render:function(){var t=this.props.isSortedColumn&&this.props.direction==n?"rdt-arrow-up-active":"rdt-arrow-up-inactive",e=this.props.isSortedColumn&&this.props.direction==o?"rdt-arrow-down-active":"rdt-arrow-down-inactive";return s.createElement("div",{style:{"float":"right"}},s.createElement("div",{"data-rdt-action":"sort","data-col-property":this.props.col.property,"data-sort-direction":n,className:"rdt-arrow-up "+t}),s.createElement("div",{style:{marginBottom:"5px"}}),s.createElement("div",{"data-rdt-action":"sort","data-col-property":this.props.col.property,"data-sort-direction":o,className:"rdt-arrow-down "+e}))}}),a=s.createClass({displayName:"RDTColumn",recordsSorted:function(t){this.setState({sortInfo:t})},getInitialState:function(){var t=this.props.datasource;return t.on("RECORDS_SORTED",this.recordsSorted),{datasource:this.props.datasource}},componentWillReceiveProps:function(t){t.datasource&&t.datasource.on("RECORDS_SORTED",this.recordsSorted)},render:function(){var t=this.props.config.cols,e=(this.state.datasource,this.state.sortInfo);return s.createElement("thead",{onClick:this.onClick},s.createElement("tr",null,t.map(function(t,r){var n=!1,o=null;return e&&e.property===t.property&&(n=!0,o=e.direction),s.createElement("td",{"data-th-key":t.property,key:t.property+"-th-"+r},s.createElement("div",null,s.createElement("span",null,t.header),s.createElement(i,{isSortedColumn:n,direction:o,col:t})))}.bind(this))))}});t.exports=a},function(t,e,r){var s=r(1),n=r(8),o=s.createClass({displayName:"RDTBody",render:function(){return s.createElement("tbody",null,this.props.datasource.map(this.props.pager,function(t,e,r){var o=e;return r&&!Array.isArray(r)&&(o=r),s.createElement(n,{datasource:this.props.datasource,index:o,key:o,record:t,config:this.props.config})}.bind(this)))}});t.exports=o},function(t,e,r){var s=r(1),n=s.createClass({displayName:"Paginator",getInitialState:function(){return{page:this.props.page}},componentWillReceiveProps:function(t){this.setState({page:t.page})},pageSelectionHandler:function(){this.props.pageChangedListener&&this.props.pageChangedListener(this.refs.pageSelection.getDOMNode().value)},render:function(){var t=this.state.page,e=[],r=parseInt(this.props.datasource.records.length/this.props.config.pager.rowsPerPage);this.props.datasource.records.length%this.props.config.pager.rowsPerPage!=0&&(r+=1);for(var n=1;r>=n;n++)e.push(n);return s.createElement("div",{className:"rdt-paginator"},s.createElement("div",null,s.createElement("select",{value:t,ref:"pageSelection",onChange:this.pageSelectionHandler},e.map(function(t){return s.createElement("option",{key:t,value:t},t)}))))}});t.exports=n},function(t){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function s(t){return"number"==typeof t}function n(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(t){if(!s(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},e.prototype.emit=function(t){var e,s,i,a,p,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(s=this._events[t],o(s))return!1;if(r(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),p=1;i>p;p++)a[p-1]=arguments[p];s.apply(this,a)}else if(n(s)){for(i=arguments.length,a=new Array(i-1),p=1;i>p;p++)a[p-1]=arguments[p];for(c=s.slice(),i=c.length,p=0;i>p;p++)c[p].apply(this,a)}return!0},e.prototype.addListener=function(t,s){var i;if(!r(s))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(s.listener)?s.listener:s),this._events[t]?n(this._events[t])?this._events[t].push(s):this._events[t]=[this._events[t],s]:this._events[t]=s,n(this._events[t])&&!this._events[t].warned){var i;i=o(this._maxListeners)?e.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){function s(){this.removeListener(t,s),n||(n=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var n=!1;return s.listener=e,this.on(t,s),this},e.prototype.removeListener=function(t,e){var s,o,i,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=this._events[t],i=s.length,o=-1,s===e||r(s.listener)&&s.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(n(s)){for(a=i;a-->0;)if(s[a]===e||s[a].listener&&s[a].listener===e){o=a;break}if(0>o)return this;1===s.length?(s.length=0,delete this._events[t]):s.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},e.prototype.removeAllListeners=function(t){var e,s;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(s=this._events[t],r(s))this.removeListener(t,s);else for(;s.length;)this.removeListener(t,s[s.length-1]);return delete this._events[t],this},e.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},e.listenerCount=function(t,e){var s;return s=t._events&&t._events[e]?r(t._events[e])?1:t._events[e].length:0}},function(t,e,r){"use strict";var s=r(1),n=(r(6),s.createClass({displayName:"RDTCell",componentWillReceiveProps:function(t){this.setState({record:t.record,editMode:!1,ds:t.ds})},convertToType:function(t,e){return"number"==typeof t?t%1===0?parseInt(e):parseFloat(e):e},getDisplayStyle:function(){var t=this.refs.td.getDOMNode(),e=t.offsetWidth,r=t.offsetHeight,s=t.offsetLeft,n=t.offsetTop;return{width:e,height:r,top:n,left:s}},componentDidMount:function(){this.refs.input&&this.refs.input.getDOMNode().focus()},componentDidUpdate:function(){this.refs.input&&this.refs.input.getDOMNode().focus()},onClickHandler:function(t){t.target;!this.state.editMode&&this.props.col.editable&&this.setState({record:this.state.record,property:this.state.property,editMode:!0})},onKeyUp:function(t){var e=t.type,r=t.which,s=13;if("keyup"===e&&r===s&&this.refs.input){{var n=this.convertToType(this.state.record[this.state.property],this.refs.input.getDOMNode().value),o=this.props.datasource;this.props.index}o.updateRecord(this.props.index,this.props.property,n,this.props.col),this.setState({record:this.state.record,editMode:!1}),this.props.onCellChange&&this.props.onCellChange()}},onBlur:function(){this.setState({editMode:!1})},getInitialState:function(){return{record:this.props.record,editMode:!1,ds:this.props.ds}},createEditor:function(){var t=this.props.col.editable||!1,e=this.state.editMode;return t&&e?s.createElement("input",{onBlur:this.onBlur,className:"rdt-editor",style:this.getDisplayStyle(),onKeyUp:this.onKeyUp,onChange:this.onInputChange,ref:"input",defaultValue:this.state.record.getValue(this.props.property)}):null},render:function(){var t=this.state.record,e=this.props.property,r=t.getValue(e);return this.props.col.formatter&&(r=this.props.col.formatter(r,e,t.__record,s)),s.createElement("td",{ref:"td",onClick:this.onClickHandler,"data-property":e,key:e},s.createElement("div",null,r),this.createEditor())}}));t.exports=n}])});